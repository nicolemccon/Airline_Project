import sqlite3
import csv
import pandas as pd
conn = sqlite3.connect("practice.db")                                                                      #4SEATS
c = conn.cursor()

#counting seats

c.execute("SELECT COUNT(seat) FROM seating")
for item in c:
    nseats = item[0]
    print("Number of seats on the plane:", nseats)

c.execute("SELECT COUNT(name) FROM seating WHERE name NOT LIKE '' ;")
for item in c:
    nnames = item[0]
    print("Number of unavailable seats:", nnames)

#db.execute("SELECT COUNT(name) FROM seating WHERE name LIKE '' ;")
#for obj in db:
 #   seat_a= obj[0]
  #  print("Number of available seats:", seat_a)  
#navail = nseats - nnames
#print("Number of available seats:", navail) """ just some refinement """
  
#seat letters and number of seats
"""c.execute("SELECT seat,count(*) from seating group by seat")
i=0
for obj in c:
    no_seats=obj[0]
    print(obj[0])
    i=i+1
print(i)
no_seats_in_row=i;"""
  

#rows and aisles

c.execute("SELECT seats FROM rows_cols;")
for item in c:
    seat_letters = item[0]
    seats_per_row = (len(seat_letters))
    print("Number of seats per row:", seats_per_row)
    print("Number of rows on the plane:", int(nseats/seats_per_row))
    
#list of empty seats

emptyseats = []
c.execute("SELECT * FROM seating WHERE name LIKE '' ;")                                                 #row|seat = primary key
for item in c:
    emptyseats.append(item)                                                                             #list of available seats
    emptyseats.sort()                                                                                   #sort by row number 
print(emptyseats)
 

df = pd.read_sql_query("SELECT * FROM seating;", conn)  # give the table name and the connection
print(df.head())

passengers_refused = 0

with open("5passenger.csv") as csvfile:
    bookings = csv.reader(csvfile, delimiter = ',')
    for row in bookings:
        name = row[0]
        passengers = (int(row[1]))
        print("Number of passengers for", name, "booking:", passengers)

        if passengers <= navail:  
            d = []
            for i in range(passengers):
                d.append(name)
            print("d",d)
            entries = ()
            navail -= len(d)
            print("navail", navail)
            #for j in range(len(d)):
                #for k in range()
                #c.execute("INSERT INTO seating VALUE ()")

        else:
            c = []
            for i in range(passengers):
                c.append(name)
            print("lengc",len(c))
            passengers_refused+=(len(c))
